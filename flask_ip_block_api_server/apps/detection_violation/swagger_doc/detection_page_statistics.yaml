tags:
  - '[메인 ,바이올레이션 ,디텍션 혼용]'
summary:
  - '[디텍션] 디텍션 통계 api'
parameters:
  - in: query
    name: page_type
    type: string
    enum: ['vulnerability', 'suspicious', 'blackip']
    required: true
responses:
  200:
    description: 디텍션페이지 디텍션 통계
    schema:
      id: detection_page_statistics
    examples:
      {
        "status": 200,
        "result": "Your request is successful",
        "message": "Request fulfilled, document follows",
        "data": {
          "score_dst_ip": [
            {
              "data_name": "99",
              "data_cnt": 468,
              "end_dtime": "2021-06-09 12:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 132,
              "end_dtime": "2021-06-09 12:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 417,
              "end_dtime": "2021-06-09 13:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 56,
              "end_dtime": "2021-06-09 13:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 8,
              "end_dtime": "2021-06-09 13:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 66,
              "end_dtime": "2021-06-09 13:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 176,
              "end_dtime": "2021-06-09 14:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 214,
              "end_dtime": "2021-06-09 14:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 54,
              "end_dtime": "2021-06-09 14:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 599,
              "end_dtime": "2021-06-09 14:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 211,
              "end_dtime": "2021-06-09 15:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 471,
              "end_dtime": "2021-06-09 15:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 963,
              "end_dtime": "2021-06-09 15:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 745,
              "end_dtime": "2021-06-09 15:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 654,
              "end_dtime": "2021-06-09 16:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 432,
              "end_dtime": "2021-06-09 16:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 445,
              "end_dtime": "2021-06-09 16:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 385,
              "end_dtime": "2021-06-09 16:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 404,
              "end_dtime": "2021-06-09 17:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 712,
              "end_dtime": "2021-06-09 17:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 736,
              "end_dtime": "2021-06-09 17:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 517,
              "end_dtime": "2021-06-09 17:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 614,
              "end_dtime": "2021-06-09 18:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 463,
              "end_dtime": "2021-06-09 18:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 236,
              "end_dtime": "2021-06-09 18:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 103,
              "end_dtime": "2021-06-09 18:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 32,
              "end_dtime": "2021-06-09 19:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 86,
              "end_dtime": "2021-06-09 19:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 90,
              "end_dtime": "2021-06-09 19:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 374,
              "end_dtime": "2021-06-09 19:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 218,
              "end_dtime": "2021-06-09 20:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 50,
              "end_dtime": "2021-06-09 20:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 57,
              "end_dtime": "2021-06-09 20:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 116,
              "end_dtime": "2021-06-09 20:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 76,
              "end_dtime": "2021-06-09 21:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 200,
              "end_dtime": "2021-06-09 21:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 294,
              "end_dtime": "2021-06-09 21:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 64,
              "end_dtime": "2021-06-09 21:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 52,
              "end_dtime": "2021-06-09 22:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 24,
              "end_dtime": "2021-06-09 22:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 30,
              "end_dtime": "2021-06-09 22:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 22,
              "end_dtime": "2021-06-09 22:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 24,
              "end_dtime": "2021-06-09 23:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 36,
              "end_dtime": "2021-06-09 23:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 56,
              "end_dtime": "2021-06-09 23:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 62,
              "end_dtime": "2021-06-09 23:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 26,
              "end_dtime": "2021-06-10 00:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 52,
              "end_dtime": "2021-06-10 00:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 32,
              "end_dtime": "2021-06-10 00:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 4,
              "end_dtime": "2021-06-10 00:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 121,
              "end_dtime": "2021-06-10 03:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 8,
              "end_dtime": "2021-06-10 04:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 14,
              "end_dtime": "2021-06-10 04:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 6,
              "end_dtime": "2021-06-10 05:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 6,
              "end_dtime": "2021-06-10 08:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 18,
              "end_dtime": "2021-06-10 08:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 42,
              "end_dtime": "2021-06-10 08:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 28,
              "end_dtime": "2021-06-10 09:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 90,
              "end_dtime": "2021-06-10 09:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 48,
              "end_dtime": "2021-06-10 09:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 92,
              "end_dtime": "2021-06-10 09:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 418,
              "end_dtime": "2021-06-10 10:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 410,
              "end_dtime": "2021-06-10 10:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 389,
              "end_dtime": "2021-06-10 10:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 383,
              "end_dtime": "2021-06-10 10:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 349,
              "end_dtime": "2021-06-10 11:00:00"
            },
            {
              "data_name": "99",
              "data_cnt": 375,
              "end_dtime": "2021-06-10 11:15:00"
            },
            {
              "data_name": "99",
              "data_cnt": 269,
              "end_dtime": "2021-06-10 11:30:00"
            },
            {
              "data_name": "99",
              "data_cnt": 455,
              "end_dtime": "2021-06-10 11:45:00"
            },
            {
              "data_name": "99",
              "data_cnt": 608,
              "end_dtime": "2021-06-10 12:00:00"
            }
          ],
          "top_dst_ip": [
            {
              "data_name": "52.79.101.137",
              "data_cnt": 772
            },
            {
              "data_name": "45.54.49.1",
              "data_cnt": 738
            },
            {
              "data_name": "104.254.148.166",
              "data_cnt": 706
            },
            {
              "data_name": "69.173.158.65",
              "data_cnt": 684
            },
            {
              "data_name": "78.46.165.80",
              "data_cnt": 680
            },
            {
              "data_name": "1.234.19.182",
              "data_cnt": 634
            },
            {
              "data_name": "104.254.148.165",
              "data_cnt": 504
            },
            {
              "data_name": "104.254.149.100",
              "data_cnt": 480
            },
            {
              "data_name": "117.52.137.217",
              "data_cnt": 426
            },
            {
              "data_name": "104.254.148.196",
              "data_cnt": 410
            }
          ],
          "top_dst_port": [
            {
              "data_name": "443",
              "data_cnt": 13890
            },
            {
              "data_name": "80",
              "data_cnt": 1576
            },
            {
              "data_name": "5222",
              "data_cnt": 27
            },
            {
              "data_name": "10000",
              "data_cnt": 4
            },
            {
              "data_name": "5000",
              "data_cnt": 4
            }
          ],
          "top_protocol": [
            {
              "data_name": "HTTPS",
              "data_cnt": 9760
            },
            {
              "data_name": "SSL",
              "data_cnt": 4128
            },
            {
              "data_name": "HTTP",
              "data_cnt": 1578
            },
            {
              "data_name": "tcp/5222",
              "data_cnt": 27
            },
            {
              "data_name": "tcp/10000",
              "data_cnt": 4
            },
            {
              "data_name": "udp/443",
              "data_cnt": 2
            },
            {
              "data_name": "5000_TCP",
              "data_cnt": 2
            }
          ],
          "top_src_ip": [
            {
              "data_name": "10.1.9.12",
              "data_cnt": 2746
            },
            {
              "data_name": "10.1.9.10",
              "data_cnt": 2076
            },
            {
              "data_name": "10.1.9.11",
              "data_cnt": 1909
            },
            {
              "data_name": "10.3.1.14",
              "data_cnt": 896
            },
            {
              "data_name": "10.1.9.9",
              "data_cnt": 873
            },
            {
              "data_name": "10.3.2.25",
              "data_cnt": 784
            },
            {
              "data_name": "10.3.1.18",
              "data_cnt": 581
            },
            {
              "data_name": "10.1.9.13",
              "data_cnt": 500
            },
            {
              "data_name": "10.1.9.4",
              "data_cnt": 432
            },
            {
              "data_name": "10.3.1.86",
              "data_cnt": 382
            }
          ],
          "top_src_port": [
            {
              "data_name": "1064",
              "data_cnt": 184
            },
            {
              "data_name": "62568",
              "data_cnt": 118
            },
            {
              "data_name": "62068",
              "data_cnt": 58
            },
            {
              "data_name": "58954",
              "data_cnt": 56
            },
            {
              "data_name": "1181",
              "data_cnt": 54
            },
            {
              "data_name": "54846",
              "data_cnt": 50
            },
            {
              "data_name": "54839",
              "data_cnt": 42
            },
            {
              "data_name": "1060",
              "data_cnt": 28
            },
            {
              "data_name": "62617",
              "data_cnt": 24
            },
            {
              "data_name": "63827",
              "data_cnt": 24
            }
          ]
        }
      }
  400:
    description: 디텍션페이지 디텍션 통계 실패
    schema:
      id: detection_page_statistics failed
    examples:
      {
        "status": 400,
        "result": "Your request is failed",
        "message": "Bad request syntax or unsupported method",
      }
